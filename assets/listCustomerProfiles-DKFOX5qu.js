import{i as k,r as n,j as e}from"./index-B9c6G4RU.js";import{B}from"./BaseCard-B7xEBDih.js";import{c as I}from"./config-DOW8WNQj.js";import{I as P}from"./search-Cu_u-BJp.js";import{B as u,T as p}from"./Box-DY5rMG6q.js";import{C as H}from"./CircularProgress-16haAPjs.js";import{A as L}from"./Alert-D64dzqcI.js";import{T as N,a as R,b as W,c as A,d as h,e as F}from"./TableRow-owgTIb2d.js";import{B as V}from"./Button-C_RbK71c.js";import"./Card-DY8qMz7M.js";import"./Paper-Djww9Kda.js";import"./createSvgIcon-CuCLOW51.js";import"./useForkRef-bxOkU-Fv.js";import"./ButtonBase-DaiUm-zC.js";import"./Divider-CID0eBmV.js";import"./CardContent-B0TW8JlS.js";import"./TextField-BzY1DWUU.js";import"./useSlot--7nv0rPO.js";import"./resolveComponentProps-lSV5xpUt.js";import"./useId--VlEiZJx.js";import"./useFormControl-iTPikZFj.js";import"./isHostComponent-kiJGbep4.js";import"./FormControl-FjhdrhiG.js";import"./isMuiElement-DYmjoWWl.js";import"./Modal-sn2O3BuZ.js";import"./ownerDocument-DW-IO8s5.js";import"./createChainedFunction-BO_9K8Jh.js";import"./Menu-Dm3AkTow.js";import"./mergeSlotProps-CeBRw_gE.js";import"./useControlled-knxWmPfA.js";import"./InputAdornment-BIIeC6kB.js";import"./IconButton-Xr0163ay.js";import"./Close-CwlFG3CA.js";const ge=()=>{const l=k(),[c,S]=n.useState([]),[g,f]=n.useState([]),[T,w]=n.useState(!0),[j,v]=n.useState(null),[m,C]=n.useState("");n.useEffect(()=>{(async()=>{try{const o=sessionStorage.getItem("token");if(!o){l("/auth/login");return}const x=new Headers;x.append("authToken",o),x.append("Content-Type","application/json");const y=await fetch(`${I.rutaApi}employee_system_list`,{method:"GET",headers:x});if(y.status===401){sessionStorage.removeItem("token"),l("/auth/login");return}if(!y.ok)throw new Error("Failed to fetch customers");const r=await y.json(),d=[],b=new Set;let i=[];if(Array.isArray(r))i=r;else if(r.employees&&Array.isArray(r.employees))i=r.employees;else if(r.data&&Array.isArray(r.data))i=r.data;else if(r.list&&Array.isArray(r.list))i=r.list;else if(r.results&&Array.isArray(r.results))i=r.results;else{const a=Object.keys(r).find(t=>Array.isArray(r[t]));a&&(i=r[a])}i.forEach(a=>{const t=a==null?void 0:a.customer;t&&typeof t=="string"&&t.trim()!==""&&!b.has(t)&&(b.add(t),d.push({customer:t}))}),d.sort((a,t)=>a.customer.localeCompare(t.customer)),S(d),f(d)}catch(o){v(o.message||"Error loading customers"),console.error("Error fetching customers:",o)}finally{w(!1)}})()},[l]),n.useEffect(()=>{if(m.trim()==="")f(c);else{const s=c.filter(o=>o.customer.toLowerCase().includes(m.toLowerCase()));f(s)}},[m,c]);const E=s=>{l(`/profiles/customerProfile?nameCustomer=${encodeURIComponent(s)}`)};return e.jsx(B,{title:"Customer Profile",children:e.jsxs(u,{children:[e.jsx(u,{sx:{mb:3},children:e.jsx(P,{searchTerm:m,onSearchChange:s=>C(s),onClearSearch:()=>C(""),placeholder:"Search by customer name...",width:"100%"})}),T?e.jsx(u,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"300px",children:e.jsx(H,{})}):j?e.jsx(L,{severity:"error",sx:{mb:2},children:j}):g.length===0?e.jsx(u,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"300px",children:e.jsx(p,{variant:"body1",color:"text.secondary",children:c.length===0?"No customers found":"No customers match your search"})}):e.jsx(N,{sx:{boxShadow:"none",border:"1px solid #eee",borderRadius:2},children:e.jsxs(R,{"aria-label":"customers table",children:[e.jsx(W,{children:e.jsxs(A,{children:[e.jsx(h,{children:e.jsx(p,{variant:"h6",fontWeight:600,children:"Customer Name"})}),e.jsx(h,{align:"center",children:e.jsx(p,{variant:"h6",fontWeight:600,children:"Actions"})})]})}),e.jsx(F,{children:g.map((s,o)=>e.jsxs(A,{hover:!0,children:[e.jsx(h,{children:e.jsx(p,{variant:"body1",fontWeight:500,children:s.customer})}),e.jsx(h,{align:"center",children:e.jsx(V,{variant:"contained",size:"small",onClick:()=>E(s.customer),sx:{backgroundColor:"#0D4B3B",color:"#ffffff",textTransform:"none","&:hover":{backgroundColor:"#0a3d32"}},children:"View Profile"})})]},o))})]})})]})})};export{ge as default};
