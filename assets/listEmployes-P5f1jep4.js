import{i as O,r as a,j as t}from"./index-CdKuqBN7.js";import{B as g,C as w}from"./BaseCard-_loVm070.js";import{c as W}from"./config-BwmyTBcy.js";import{I as H}from"./search-BzPnWygK.js";import{x as d}from"./xlsx.min-eSKj14Fn.js";import{T as i,B as E}from"./Box-DLGFS5Nm.js";import{T as G}from"./TableContainer-DKHxI6tH.js";import{T as U,a as $,b as T,c as r,d as q}from"./TableRow-Di8HXcUV.js";import{S as k}from"./Stack-CrMDBv9k.js";import{T as M}from"./TablePagination-DS4tLdMr.js";import{B as V}from"./Button-CQV6I-S2.js";import"./Card-CODsJ4pi.js";import"./Paper-B-zzGPXh.js";import"./createSvgIcon-uoZC_phk.js";import"./useForkRef-DP9u9f1c.js";import"./ButtonBase-Ch1OulNA.js";import"./Divider-8anQKdRu.js";import"./CardContent-iJy71Myg.js";import"./TextField-BLo_t3tD.js";import"./useSlot-BzxcFuiT.js";import"./resolveComponentProps-c4ZPQ34S.js";import"./useId-DFIta1l-.js";import"./useFormControl-CmLWHudv.js";import"./isHostComponent-B_ZoZx9v.js";import"./FormControl-CG1yQZLc.js";import"./isMuiElement-D0Iek_Oh.js";import"./Menu-Cik9qt9R.js";import"./mergeSlotProps-CFjJG2S3.js";import"./createChainedFunction-BO_9K8Jh.js";import"./useControlled-C4r7w1eh.js";import"./InputAdornment-168PFDV8.js";import"./IconButton-2YB8rd0-.js";import"./CircularProgress-DHGEJ6_p.js";import"./useThemeProps-D4OFX-ze.js";import"./Toolbar-Dki6s93V.js";const Pt=()=>{const P=O(),[h,A]=a.useState([]),[f,b]=a.useState([]),[z,C]=a.useState(!0),[l,v]=a.useState(""),[x,y]=a.useState(0),[c,B]=a.useState(15);a.useEffect(()=>{const e=sessionStorage.getItem("token");if(!e){console.error("Token not found"),C(!1);return}const o=new Headers;o.append("authToken",e);const u={method:"GET",headers:o,redirect:"follow"};fetch(`${W.rutaApi}employee_system_list`,u).then(n=>n.json()).then(async n=>{const S=Array.isArray(n.dataEmployees)?n.dataEmployees:[n.dataEmployees],m=await Promise.all(S.map(async s=>{const _=s.status;let p,j;return _==="Active"?(p="Active",j="success.main"):_==="Not Active"?(p="Not Active",j="error.main"):(p="A stranger",j="warning.main"),{id:s.id_employee,full_name:s.full_name,document_type:s.document_type,document_number:s.document_number,gender:s.gender,birthday:s.birthday,civil_status:s.civil_status,nationality:s.nationality,active_since:s.active_since,active_until:s.active_until,status:p,pbg:j}}));A(m),b(m)}).catch(n=>console.error("Error:",n)).finally(()=>C(!1))},[]),a.useEffect(()=>{if(l==="")b(h);else{const e=h.filter(o=>o.full_name.toLowerCase().includes(l.toLowerCase())||o.document_number.toLowerCase().includes(l.toLowerCase()));b(e)}},[l,h]);const N=()=>{const e=f.map(n=>({"Full Name":n.full_name,"Document Type":n.document_type,"Document Number":n.document_number,Gender:n.gender,Birthday:n.birthday,"Civil Status":n.civil_status,Nationality:n.nationality,"Active Since":n.active_since,"Active Until":n.active_until,Status:n.status})),o=d.utils.json_to_sheet(e);e.length>0&&Object.keys(e[0]).forEach((S,m)=>{const s=d.utils.encode_cell({r:0,c:m});o[s]&&(o[s].s={fill:{fgColor:{rgb:"B8CCE4"}},font:{color:{rgb:"222222"},bold:!1},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"CCCCCC"}},bottom:{style:"thin",color:{rgb:"CCCCCC"}},left:{style:"thin",color:{rgb:"CCCCCC"}},right:{style:"thin",color:{rgb:"CCCCCC"}}}})});const u=d.utils.book_new();d.utils.book_append_sheet(u,o,"Employees"),d.writeFile(u,"employees_list.xlsx",{bookType:"xlsx"})},D=e=>{v(e)},L=()=>{v("")},F=(e,o)=>{y(o)},I=e=>{B(parseInt(e.target.value,10)),y(0)},R=e=>{P(`/employees/showEmploye/${e}`)};return z?t.jsx(g,{title:"Loading...",children:t.jsx(i,{variant:"body1",children:"Load all employees..."})}):h.length===0?t.jsx(g,{title:"Not Found Employees.",children:t.jsx(i,{variant:"body1",children:"Not Found Employees."})}):t.jsxs(g,{title:t.jsxs(E,{sx:{display:"flex",alignItems:"center",width:"100%",gap:{xs:2,sm:4},flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between"},children:[t.jsx(i,{variant:"h5",sx:{width:{xs:"100%",sm:"auto"},textAlign:{xs:"left",sm:"inherit"}},children:"EMPLOYEES"}),t.jsx(E,{sx:{flex:1,display:"flex",justifyContent:"center"},children:t.jsx(H,{searchTerm:l,onSearchChange:D,onClearSearch:L,placeholder:"Buscar empleados...",width:{xs:"100%",sm:300,md:400}})}),t.jsx(V,{variant:"contained",color:"success",size:"small",onClick:N,sx:{minWidth:140},children:"Download Excel"})]}),children:[t.jsx(G,{sx:{width:{xs:"100%",sm:"100%"},overflowX:"auto"},children:t.jsxs(U,{"aria-label":"simple table",sx:{whiteSpace:"nowrap"},children:[t.jsx($,{children:t.jsxs(T,{children:[t.jsx(r,{children:t.jsx(i,{variant:"subtitle1",children:"No."})}),t.jsx(r,{children:t.jsx(i,{variant:"subtitle1",children:"Full Name"})}),t.jsx(r,{children:t.jsx(i,{variant:"subtitle1",children:"Document Type"})}),t.jsx(r,{children:t.jsx(i,{variant:"subtitle1",children:"Document Number"})}),t.jsx(r,{children:t.jsx(i,{variant:"subtitle1",children:"gender"})}),t.jsx(r,{children:t.jsx(i,{variant:"subtitle1",children:"birthday"})}),t.jsx(r,{children:t.jsx(i,{variant:"subtitle1",children:"Civil Status"})}),t.jsx(r,{children:t.jsx(i,{variant:"subtitle1",children:"Nationality"})}),t.jsx(r,{children:t.jsx(i,{variant:"subtitle1",children:"Active Since"})}),t.jsx(r,{children:t.jsx(i,{variant:"subtitle1",children:"Active Until"})}),t.jsx(r,{children:t.jsx(i,{variant:"subtitle1",children:"Status"})}),t.jsx(r,{children:t.jsx(i,{variant:"subtitle1",children:"Action"})})]})}),t.jsx(q,{children:f.slice(x*c,x*c+c).map((e,o)=>t.jsxs(T,{children:[t.jsx(r,{children:t.jsx(i,{fontSize:"15px",fontWeight:500,children:o+1+x*c})}),t.jsx(r,{children:t.jsx(i,{color:"textSecondary",fontSize:"14px",children:e.full_name})}),t.jsx(r,{children:t.jsx(i,{color:"textSecondary",fontSize:"14px",children:e.document_type})}),t.jsx(r,{children:t.jsx(i,{color:"textSecondary",fontSize:"14px",children:e.document_number})}),t.jsx(r,{children:t.jsx(i,{color:"textSecondary",fontSize:"14px",children:e.gender})}),t.jsx(r,{children:t.jsx(i,{color:"textSecondary",fontSize:"14px",children:e.birthday})}),t.jsx(r,{children:t.jsx(i,{color:"textSecondary",fontSize:"14px",children:e.civil_status})}),t.jsx(r,{children:t.jsx(i,{color:"textSecondary",fontSize:"14px",children:e.nationality})}),t.jsx(r,{children:t.jsx(i,{color:"textSecondary",fontSize:"14px",children:e.active_since})}),t.jsx(r,{children:t.jsx(i,{color:"textSecondary",fontSize:"14px",children:e.active_until})}),t.jsx(r,{children:t.jsx(k,{direction:"row",spacing:1,children:t.jsx(w,{label:e.status,sx:{backgroundColor:e.pbg,color:"white",fontWeight:"600",fontSize:"0.75rem"}})})}),t.jsx(r,{children:t.jsx(k,{direction:"row",spacing:1,children:t.jsx(w,{label:"Show",onClick:()=>R(e.id),sx:{backgroundColor:"#0D4B3B",color:"white",fontWeight:"600",fontSize:"0.75rem",cursor:"pointer","&:hover":{backgroundColor:"#0a3d32"}}})})})]},e.id))})]})}),t.jsx(M,{component:"div",count:f.length,page:x,onPageChange:F,rowsPerPage:c,onRowsPerPageChange:I,rowsPerPageOptions:[15,30,50],sx:{mt:1}})]})};export{Pt as default};
